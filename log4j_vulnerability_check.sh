#!/bin/bash
find / -iname log4j-core*|egrep -v "1.[0-9].[0-9]|2.15|2.16" > /tmp/log4jcheck.txt
log4j_file_check=`cat /tmp/log4jcheck.txt |wc -l`

if [ $log4j_file_check -eq 0 ]; then
	echo "there isn't affected log4j version."
	exit 0
else
	for i in $(cat /tmp/log4jcheck.txt); do
	log4j_vulnerability_check=`strings $i |grep -c JndiLookup.class`
	if [ $log4j_vulnerability_check -gt 0 ]; then
		echo "############## log4j vulnerability is here!!! ##############"
		echo $i; strings $i |grep -i JndiLookup.class
		exit 0
	else
		echo "there isn't 'JndiLookup.class' classpath in the log4j file"
		echo $i
		exit 0
	fi
	done
fi
