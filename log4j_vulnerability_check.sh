#!/bin/bash
find / -iname log4j-core*|grep -v "2.15" > /tmp/log4jcheck.txt
log4j_file_check=`cat /tmp/log4jcheck.txt |wc -l`

if [ $log4j_file_check -eq 0 ]; then
	echo "there isn't affected log4j version"
	exit 0
else
	for i in $(cat /tmp/log4jcheck.txt); do
	log4j_vulnerability_check=`strings $i |grep -c JndiLookup.class`
	if [ $log4j_vulnerability_check -gt 0 ]; then
		echo "############## log4j vulnerability is here. ##############"
		echo $i; strings $i |grep -i JndiLookup.class
		exit 0
	else
		echo ""############## there is log4j-core file but not JndiLookup.class in the file. "##############"
		echo $i
		exit 0
	fi
	done
fi
